<script>
	import { onMount } from "svelte";
	import Assessment from "../routes/assessment.svelte";
	import Dashboard from "../routes/dashboard.svelte";
	import { store } from "./store.js";
	export let segment;

	let open, width, nav;
	store.subscribe((value) => (open = value.open));

	// for some reason (possibly ssr) i have to mount the dom before sending width value to store
	onMount(() => store.set({ width }));

	// updates store with open status and width of nav
	const toggleNav = () => store.set({ open: !open, width });
	let pageWidth;

	// for times when i serve localhost over https using ngrok
	$: if (nav && pageWidth < 1124) {
		if (nav.style.position === "relative") {
			nav.style.position = "fixed";
			console.log(nav.style.position);
		}
	} else if (nav && pageWidth > 1124) {
		nav.style.position = "relative";
	}
</script>

<svelte:window bind:innerWidth={pageWidth} />

<nav
	class:open
	class:hidden={segment === undefined}
	style="--nav-width: -{width}px"
	bind:this={nav}
	bind:clientWidth={width}
>
	<div class="logo-wrapper">
		<img src="images/baze-logo.png" alt="" />
		<h1>BAZE UNIVERSITY ABUJA</h1>
	</div>

	<section class="navlinks">
		<a
			href="dashboard"
			class="navlinks-item"
			on:click={toggleNav}
			rel="prefetch"
			class:active={segment === "dashboard"}>
			<svg
				width="16"
				height="16"
				viewBox="0 0 16 16"
				fill="none"
				xmlns="http://www.w3.org/2000/svg">
				<g clip-path="url(#clip0)">
					<path
						d="M6.33333 5.33333H1C0.448667 5.33333 0 4.88467 0 4.33333V1C0 0.448667 0.448667 0 1 0H6.33333C6.88467 0 7.33333 0.448667 7.33333 1V4.33333C7.33333 4.88467 6.88467 5.33333 6.33333 5.33333ZM1 0.666667C0.816667 0.666667 0.666667 0.816 0.666667 1V4.33333C0.666667 4.51733 0.816667 4.66667 1 4.66667H6.33333C6.51667 4.66667 6.66667 4.51733 6.66667 4.33333V1C6.66667 0.816 6.51667 0.666667 6.33333 0.666667H1Z"
						fill="#535968"
					/>
					<path
						d="M6.33333 16H1C0.448667 16 0 15.5514 0 15V7.66669C0 7.11535 0.448667 6.66669 1 6.66669H6.33333C6.88467 6.66669 7.33333 7.11535 7.33333 7.66669V15C7.33333 15.5514 6.88467 16 6.33333 16ZM1 7.33335C0.816667 7.33335 0.666667 7.48269 0.666667 7.66669V15C0.666667 15.184 0.816667 15.3334 1 15.3334H6.33333C6.51667 15.3334 6.66667 15.184 6.66667 15V7.66669C6.66667 7.48269 6.51667 7.33335 6.33333 7.33335H1Z"
						fill="#535968"
					/>
					<path
						d="M15.0001 16H9.66675C9.11541 16 8.66675 15.5514 8.66675 15V11.6667C8.66675 11.1154 9.11541 10.6667 9.66675 10.6667H15.0001C15.5514 10.6667 16.0001 11.1154 16.0001 11.6667V15C16.0001 15.5514 15.5514 16 15.0001 16ZM9.66675 11.3334C9.48341 11.3334 9.33341 11.4827 9.33341 11.6667V15C9.33341 15.184 9.48341 15.3334 9.66675 15.3334H15.0001C15.1834 15.3334 15.3334 15.184 15.3334 15V11.6667C15.3334 11.4827 15.1834 11.3334 15.0001 11.3334H9.66675Z"
						fill="#535968"
					/>
					<path
						d="M15.0001 9.33333H9.66675C9.11541 9.33333 8.66675 8.88467 8.66675 8.33333V1C8.66675 0.448667 9.11541 0 9.66675 0H15.0001C15.5514 0 16.0001 0.448667 16.0001 1V8.33333C16.0001 8.88467 15.5514 9.33333 15.0001 9.33333ZM9.66675 0.666667C9.48341 0.666667 9.33341 0.816 9.33341 1V8.33333C9.33341 8.51733 9.48341 8.66667 9.66675 8.66667H15.0001C15.1834 8.66667 15.3334 8.51733 15.3334 8.33333V1C15.3334 0.816 15.1834 0.666667 15.0001 0.666667H9.66675Z"
						fill="#535968"
					/>
				</g>
				<defs>
					<clipPath id="clip0">
						<rect width="16" height="16" fill="white" />
					</clipPath>
				</defs>
			</svg>
			<span>Dashboard</span>
		</a>
		<a
			href="assessment"
			class="navlinks-item"
			rel="prefetch"
			class:active={segment === "assessment"}
			on:click={toggleNav}>
			<svg
				width="16"
				height="16"
				viewBox="0 0 16 16"
				fill="none"
				xmlns="http://www.w3.org/2000/svg">
				<path
					d="M14.359 2.25645C14.3377 2.02334 14.1417 1.84521 13.9077 1.84619H3.26152C3.05885 1.82354 2.8762 1.96944 2.85354 2.17211C2.85193 2.18648 2.85119 2.20097 2.85127 2.21542L2.76921 11.8975H0.451287C0.20401 11.9354 0.0163333 12.1402 0 12.3898V13.0667C0.0310176 14.5368 1.19771 15.7304 2.66665 15.7949H11.6513C13.1467 15.795 14.359 14.5827 14.359 13.0873C14.359 13.0805 14.359 13.0736 14.359 13.0668V2.25645ZM2.76925 14.9744C1.70884 14.9747 0.842855 14.1269 0.820515 13.0667V12.718H8.82051V13.0667C8.82263 13.7879 9.11899 14.4769 9.64103 14.9744H2.76925ZM13.5385 13.0667C13.5385 14.143 12.666 15.0155 11.5897 15.0155C10.5135 15.0155 9.64099 14.143 9.64099 13.0667V12.3898C9.64099 12.1642 9.49741 11.8975 9.27176 11.8975H3.58976L3.67182 2.66671H13.5385V13.0667H13.5385Z"
					fill="#535968"
				/>
				<path
					d="M4.98472 5.53854H8.16422C8.39081 5.53854 8.57448 5.35487 8.57448 5.12828C8.57448 4.90169 8.39081 4.71802 8.16422 4.71802H4.98472C4.75813 4.71802 4.57446 4.90169 4.57446 5.12828C4.57446 5.35487 4.75813 5.53854 4.98472 5.53854Z"
					fill="#535968"
				/>
				<path
					d="M4.98472 7.795H11.4462C11.6728 7.795 11.8565 7.61133 11.8565 7.38475C11.8565 7.15816 11.6728 6.97449 11.4462 6.97449H4.98472C4.75813 6.97449 4.57446 7.15816 4.57446 7.38475C4.57446 7.61133 4.75813 7.795 4.98472 7.795Z"
					fill="#535968"
				/>
				<path
					d="M4.98472 10.2564H11.4462C11.6728 10.2564 11.8565 10.0728 11.8565 9.84617C11.8565 9.61959 11.6728 9.43591 11.4462 9.43591H4.98472C4.75813 9.43591 4.57446 9.61959 4.57446 9.84617C4.57446 10.0728 4.75813 10.2564 4.98472 10.2564Z"
					fill="#535968"
				/>
				<path
					d="M15.5488 0.205204H4.90269C4.6761 0.205204 4.49243 0.388876 4.49243 0.615462C4.49243 0.842047 4.6761 1.02572 4.90269 1.02572H15.1796V11.4257C15.1796 11.6523 15.3633 11.836 15.5899 11.836C15.8165 11.836 16.0001 11.6523 16.0001 11.4257V0.615462C15.9789 0.382358 15.7829 0.204223 15.5488 0.205204Z"
					fill="#535968"
				/>
			</svg>
			<span>Assessment</span>
		</a>
		<a
			href="studprof"
			class="navlinks-item"
			class:active={segment === "studprof"}
			on:click={toggleNav}>
			<svg
				width="16"
				height="16"
				viewBox="0 0 16 16"
				fill="none"
				xmlns="http://www.w3.org/2000/svg">
				<path
					d="M5.40625 15.375C5.40625 15.7202 5.12646 16 4.78125 16H3.34375C1.96521 16 0.84375 14.8785 0.84375 13.5V2.5C0.84375 1.12146 1.96521 0 3.34375 0H11.0278C12.4062 0 13.5278 1.12146 13.5278 2.5V6.21875C13.5278 6.56396 13.2479 6.84375 12.9028 6.84375C12.5576 6.84375 12.2778 6.56396 12.2778 6.21875V2.5C12.2778 1.81079 11.717 1.25 11.0278 1.25H3.34375C2.65454 1.25 2.09375 1.81079 2.09375 2.5V13.5C2.09375 14.1892 2.65454 14.75 3.34375 14.75H4.78125C5.12646 14.75 5.40625 15.0298 5.40625 15.375ZM11.0277 4.375C11.0277 4.02979 10.7479 3.75 10.4027 3.75H3.96521C3.62012 3.75 3.34021 4.02979 3.34021 4.375C3.34021 4.72021 3.62012 5 3.96521 5H10.4027C10.7479 5 11.0277 4.72021 11.0277 4.375ZM8.53125 6.875C8.53125 6.52979 8.25146 6.25 7.90625 6.25H3.96521C3.62012 6.25 3.34021 6.52979 3.34021 6.875C3.34021 7.22021 3.62012 7.5 3.96521 7.5H7.90625C8.25146 7.5 8.53125 7.22021 8.53125 6.875ZM3.96521 8.75C3.62012 8.75 3.34021 9.02979 3.34021 9.375C3.34021 9.72021 3.62012 10 3.96521 10H6.5625C6.90771 10 7.1875 9.72021 7.1875 9.375C7.1875 9.02979 6.90771 8.75 6.5625 8.75H3.96521ZM14.869 15.535C14.6285 15.8306 14.2737 16 13.8954 16H7.79211C7.41174 16 7.05579 15.8307 6.81555 15.5355C6.57385 15.2385 6.47998 14.8527 6.55798 14.4769C6.75989 13.5043 7.29468 12.6193 8.06372 11.9849C8.35498 11.7446 8.67505 11.5447 9.0144 11.3884C8.63623 10.9589 8.40625 10.396 8.40625 9.78015C8.40625 8.43604 9.49963 7.34265 10.8438 7.34265C12.1879 7.34265 13.2812 8.43604 13.2812 9.78015C13.2812 10.396 13.0513 10.9589 12.6731 11.3884C13.0125 11.5447 13.3325 11.7445 13.6238 11.9849C14.3774 12.6066 14.906 13.469 15.1169 14.4186C15.1218 14.4351 15.126 14.4517 15.1295 14.4686C15.2079 14.8466 15.1129 15.2352 14.869 15.535ZM9.65625 9.78015C9.65625 10.4349 10.189 10.9677 10.8438 10.9677C11.4985 10.9677 12.0312 10.4349 12.0312 9.78015C12.0312 9.12537 11.4985 8.59265 10.8438 8.59265C10.189 8.59265 9.65625 9.12537 9.65625 9.78015ZM13.9059 14.7323L13.9056 14.7311C13.6055 13.2856 12.3177 12.2365 10.8438 12.2365C9.36975 12.2365 8.08191 13.2856 7.78186 14.7311C7.77905 14.7451 7.7887 14.7498 7.7887 14.7498C7.7887 14.7498 7.79004 14.75 7.79211 14.75H13.8954C13.8954 14.75 13.9042 14.7433 13.9059 14.7323Z"
					fill="#535968"
				/>
			</svg>
			<span>Student Profile</span>
		</a>
		<a
			href="registration"
			class="navlinks-item"
			class:active={segment === "registration"}
			on:click={toggleNav}>
			<svg
				width="16"
				height="16"
				viewBox="0 0 16 16"
				fill="none"
				xmlns="http://www.w3.org/2000/svg">
				<path
					d="M11.0144 6.875C11.0144 6.52981 10.7346 6.25 10.3894 6.25H3.95191C3.60672 6.25 3.3269 6.52981 3.3269 6.875C3.3269 7.22019 3.60672 7.5 3.95191 7.5H10.3894C10.7346 7.5 11.0144 7.22019 11.0144 6.875Z"
					fill="#535968"
				/>
				<path
					d="M3.9519 8.75C3.60672 8.75 3.3269 9.02981 3.3269 9.375C3.3269 9.72019 3.60672 10 3.9519 10H7.86161C8.2068 10 8.48661 9.72019 8.48661 9.375C8.48661 9.02981 8.2068 8.75 7.86161 8.75H3.9519Z"
					fill="#535968"
				/>
				<path
					d="M5.4206 14.75H3.33032C2.64107 14.75 2.08032 14.1892 2.08032 13.5V2.5C2.08032 1.81075 2.64107 1.25 3.33032 1.25H11.0144C11.7036 1.25 12.2644 1.81075 12.2644 2.5V6.34375C12.2644 6.68894 12.5442 6.96875 12.8894 6.96875C13.2345 6.96875 13.5144 6.68894 13.5144 6.34375V2.5C13.5144 1.1215 12.3929 0 11.0144 0H3.33032C1.95182 0 0.830322 1.1215 0.830322 2.5V13.5C0.830322 14.8785 1.95182 16 3.33032 16H5.4206C5.76579 16 6.0456 15.7202 6.0456 15.375C6.0456 15.0298 5.76579 14.75 5.4206 14.75Z"
					fill="#535968"
				/>
				<path
					d="M14.6215 9.0491C13.8904 8.31804 12.7009 8.31801 11.9703 9.0486L8.539 12.4724C8.46612 12.5451 8.41237 12.6346 8.38243 12.7331L7.63515 15.1933C7.5689 15.4114 7.62662 15.6483 7.78581 15.8114C7.90506 15.9336 8.06706 16 8.23322 16C8.28881 16 8.34493 15.9925 8.40003 15.9773L10.9227 15.2785C11.0265 15.2497 11.1211 15.1946 11.1974 15.1185L14.6215 11.7008C15.3526 10.9697 15.3526 9.78023 14.6215 9.0491ZM10.4306 14.1177L9.1615 14.4693L9.5329 13.2465L11.8482 10.9364L12.7322 11.8204L10.4306 14.1177ZM13.7381 10.8165L13.617 10.9374L12.7331 10.0535L12.8538 9.93304C13.0975 9.68935 13.494 9.68935 13.7377 9.93304C13.9813 10.1767 13.9813 10.5732 13.7381 10.8165Z"
					fill="#535968"
				/>
				<path
					d="M10.3894 3.75H3.95191C3.60672 3.75 3.3269 4.02981 3.3269 4.375C3.3269 4.72019 3.60672 5 3.95191 5H10.3894C10.7346 5 11.0144 4.72019 11.0144 4.375C11.0144 4.02981 10.7346 3.75 10.3894 3.75Z"
					fill="#535968"
				/>
			</svg>
			<span>Registration</span>
		</a>
		<a href="." class="navlinks-item" on:click={toggleNav}>
			<svg
				width="20"
				height="20"
				viewBox="0 0 20 20"
				fill="none"
				xmlns="http://www.w3.org/2000/svg">
				<path
					d="M0 4.93768V15.0621C0 16.4572 1.13808 17.5952 2.53314 17.5952H10.7159C12.111 17.5952 13.249 16.4572 13.249 15.0621V13.4223C13.249 13.1449 13.0247 12.9206 12.7473 12.9206C12.4699 12.9206 12.2456 13.1449 12.2456 13.4223V15.0621C12.2456 15.9065 11.5562 16.5959 10.7118 16.5959H2.53314C1.68876 16.5959 0.999388 15.9065 0.999388 15.0621V4.93768C0.999388 4.0933 1.68876 3.40393 2.53314 3.40393H10.7159C11.5603 3.40393 12.2496 4.0933 12.2496 4.93768V6.5775C12.2496 6.85488 12.474 7.07923 12.7514 7.07923C13.0288 7.07923 13.2531 6.85488 13.2531 6.5775V4.93768C13.2531 3.54262 12.115 2.40454 10.72 2.40454H2.53314C1.13808 2.40454 0 3.53854 0 4.93768Z"
					fill="#535968"
				/>
				<path
					d="M15.721 13.773C15.8189 13.8709 15.9454 13.9199 16.0759 13.9199C16.2064 13.9199 16.3329 13.8709 16.4308 13.773L19.8532 10.3506C20.049 10.1548 20.049 9.84073 19.8532 9.64493L16.4308 6.22253C16.235 6.02673 15.9209 6.02673 15.7251 6.22253C15.5293 6.41833 15.5293 6.73243 15.7251 6.92822L18.2949 9.49809H8.91702C8.63964 9.49809 8.41528 9.72244 8.41528 9.99982C8.41528 10.2772 8.63964 10.5016 8.91702 10.5016H18.2909L15.721 13.0714C15.5252 13.2631 15.5252 13.5813 15.721 13.773Z"
					fill="#535968"
				/>
			</svg>
			<span>Logout</span>
		</a>
	</section>
</nav>

<style lang="scss">
	nav {
		background: #ffffff;
		padding: 20px;
		box-shadow: 2px 0px 16px #dfe2ea;
		z-index: 1;
		// border-right: 0.3px solid rgba(83, 89, 104, 0.2);

		&.hidden {
			display: none;
		}
	}

	.logo-wrapper {
		width: 100%;
		padding: 20px;
		margin: 0 0 20px;
		display: grid;
		place-items: center;

		h1 {
			font-size: var(--font-size-smaller);
			font-weight: 400;
			text-align: center;
			margin-top: 10px;
		}
	}

	.navlinks {
		width: 100%;
		height: calc(100% - 220px);
		display: flex;
		flex-direction: column;

		&-item {
			padding: 14px;
			font-size: var(--font-size-smaller);
			display: flex;
			align-items: center;

			// gets rid of annoying blue highlight color when clicked on mobile view
			-webkit-tap-highlight-color: transparent;

			&:not(:last-child) {
				margin-bottom: 10px;
			}

			&:last-child {
				margin-top: auto;
				background: inherit;
				box-shadow: 0px 5px 16px #dfe2ea;
				border-radius: var(--basic-radius);
			}

			svg {
				margin: 0 15px 0 10px;
			}

			&.active {
				color: var(--active-color);
				background: var(--active-bg);
				border-radius: var(--basic-radius);

				svg * {
					fill: var(--active-color);
				}
			}
		}
	}

	@media screen and (max-width: 1124px) {
		nav {
			position: fixed;
			top: 0;
			left: 0;
			box-shadow: none;
			height: max(600px, 100%);
			display: inline-block;

			// for sliding nav
			transform: translateX(var(--nav-width));
			transition: transform 0.45s;

			&.open {
				// for sliding nav
				transform: translateX(0);
			}
		}
	}

	@media screen and (max-width: 728px) {
		nav {
			// for overlapping nav only
			transform: none;
			z-index: -1;
			transition: none;

			&.open {
				// for overlapping nav only
				z-index: 1;
				transition: 1s;
			}
		}
	}
</style>
